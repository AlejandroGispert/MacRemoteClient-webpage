---
import Navbar from '../components/layout/Navbar.svelte';
import Footer from '../components/layout/Footer.astro';
import Toaster from '../components/Toaster.svelte';
import FirebaseAnalytics from '../components/FirebaseAnalytics.svelte';
import UmamiAnalytics from '../components/UmamiAnalytics.svelte';
import ClarityAnalytics from '../components/ClarityAnalytics.svelte';
import ConsentBanner from '../components/ConsentBanner.svelte';

interface Props {
	title: string;
	description?: string;
	image?: string;
}

const { title, description = "Mac Remote Controller is a free app that lets you manage your Mac computer remotely from your android phone. Features include media control, file triggering, app integration with applications you have installed, plus secure encrypted authentication. Works over Wi-Fi or mobile hotspot. Download now for Android.", image = "/macremoteapp.png" } = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site || 'https://macremotecontrollerwebpage.netlify.app/').href;
const fullImageURL = new URL(image, Astro.site || 'https://macremotecontrollerwebpage.netlify.app/').href;
---

<!doctype html>
<html lang="en" class="h-full">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="google-site-verification" content="5qbMdjrEaqtFrDIQT3o2NbPM76SESoc3IJTF363ODAs" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="keywords" content="Mac remote control, Android remote control, Mac controller app, remote Mac access, Mac phone control, Android Mac integration, remote desktop Android, Mac media control, Mac file management, Mac remote app" />
		<meta name="author" content="Mac Remote Controller" />
		<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
		
		<!-- Canonical URL -->
		<link rel="canonical" href={canonicalURL} />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={fullImageURL} />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:site_name" content="Mac Remote Controller" />
		
		<!-- Twitter Card -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={fullImageURL} />
		
		<!-- Preconnect to external domains -->
		<link rel="preconnect" href="https://play.google.com" crossorigin />
		
		<!-- Icons -->
		<link rel="icon" type="image/png" href="/ic_launcher_round.png" />
		<link rel="apple-touch-icon" href="/1024.png" />
		<link rel="icon" type="image/png" sizes="1024x1024" href="/1024.png" />
		
		<!-- Preload critical resources -->
		<link rel="preload" href="/macremoteapp.png" as="image" />
		
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		
		<!-- Structured Data (JSON-LD) - Enhanced for Generative Engine Optimization -->
		<script type="application/ld+json" set:html={JSON.stringify({
			"@context": "https://schema.org",
			"@graph": [
				{
					"@type": "SoftwareApplication",
					"name": "Mac Remote Controller",
					"applicationCategory": "UtilityApplication",
					"operatingSystem": ["Android", "macOS"],
					"offers": {
						"@type": "Offer",
						"price": "0",
						"priceCurrency": "DKK",
						"availability": "https://schema.org/InStock"
					},
					"aggregateRating": {
						"@type": "AggregateRating",
						"ratingValue": "4.5",
						"ratingCount": "100"
					},
					"description": description,
					"featureList": [
						"Smart App Following - Interface adapts to active Mac applications",
						"Flexible Connectivity - Works over Wi-Fi or mobile hotspot",
						"File & Workspace Management - Organize folders and batch operations",
						"Application Integration - Interacts with the applications you have installed on your Mac",
						"Complete System Control - Media playback, volume, brightness, window management",
						"Enterprise Security - Encrypted authentication and secure local network communication"
					],
					"screenshot": [
						"https://macremotecontrollerwebpage.netlify.app/screenshots/appscreen.jpg",
						"https://macremotecontrollerwebpage.netlify.app/screenshots/appscreen2.jpg",
						"https://macremotecontrollerwebpage.netlify.app/screenshots/appscreen3.jpg",
						"https://macremotecontrollerwebpage.netlify.app/screenshots/appscreen4.jpg"
					],
					"downloadUrl": "https://play.google.com/store/apps/details?id=com.gispert.macremotecontrollerandroid",
					"softwareVersion": "2.0",
					"datePublished": "2024-01-01",
					"author": {
						"@type": "Organization",
						"name": "Mac Remote Controller"
					}
				},
				{
					"@type": "Organization",
					"name": "Mac Remote Controller",
					"url": "https://macremotecontrollerwebpage.netlify.app",
					"logo": "https://macremotecontrollerwebpage.netlify.app/macremoteapp.png",
					"sameAs": [
						"https://play.google.com/store/apps/details?id=com.gispert.macremotecontrollerandroid"
					]
				},
				{
					"@type": "WebSite",
					"name": "Mac Remote Controller",
					"url": "https://macremotecontrollerwebpage.netlify.app",
					"description": description,
					"inLanguage": "en",
					"potentialAction": {
						"@type": "SearchAction",
						"target": "https://macremotecontrollerwebpage.netlify.app/?q={search_term_string}",
						"query-input": "required name=search_term_string"
					}
				}
			]
		})} />
	</head>
	<body class="min-h-full">
		<!-- Skip to main content link for keyboard navigation -->
		<a href="#main-content" class="skip-link">Skip to main content</a>
		
		<!-- Ensure page starts at top, especially on mobile -->
		<script is:inline>
			// Prevent scroll restoration and ensure page starts at top
			if ('scrollRestoration' in history) {
				history.scrollRestoration = 'manual';
			}
			// Scroll to top on page load
			(function() {
				function scrollToTop() {
					window.scrollTo(0, 0);
				}
				// Scroll immediately if page is already loaded
				if (document.readyState === 'complete') {
					scrollToTop();
				} else {
					window.addEventListener('load', scrollToTop);
					document.addEventListener('DOMContentLoaded', scrollToTop);
				}
			})();
		</script>
		
		<Navbar client:load />
		<main id="main-content">
			<slot />
		</main>
		<Footer />
		<ConsentBanner client:load />
		<Toaster client:idle />
		<FirebaseAnalytics client:idle />
		<UmamiAnalytics client:idle />
		<ClarityAnalytics client:idle />
	</body>
</html>

<style>
	html {
		overflow-y: auto;
		scroll-behavior: smooth;
	}
	
	body {
		font-family: system-ui, sans-serif;
		margin: 0;
		padding: 0;
		background: #0f0f23;
		color: #fff;
		position: relative;
		min-height: 100vh;
		background-image: url('/background2.svg');
	}
	
	body::before {
		content: '';
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		/* Default PNG fallback */
		background-image: url('/background.png');
		background-position: center center;
		background-attachment: scroll;
		background-size: cover;
		background-repeat: no-repeat;
		z-index: -1;
		transform: translate3d(0, 0, 0);
		will-change: transform;
	}

	/* Modern browsers: Use WebP if supported */
	@supports (background-image: url('data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=')) {
		body::before {
			background-image: url('/background_lossless.webp');
		}
	}

	/* Reduce layout/paint cost for below-the-fold sections */
	:global(main > section:not(.hero-section)) {
		content-visibility: auto;
		contain-intrinsic-size: 900px;
	}
	
	.skip-link {
		position: absolute;
		top: -200px;
		left: 0;
		background: #0f0f23;
		color: white;
		padding: 0.75rem 1.5rem;
		text-decoration: none;
		z-index: 10000;
		border-radius: 0 0 0.5rem 0;
		font-weight: 600;
		transition: top 0.2s;
		border: 2px solid rgba(255, 255, 255, 0.3);
		clip: rect(0, 0, 0, 0);
		clip-path: inset(50%);
	}
	
	.skip-link:focus {
		top: 0;
		outline: 3px solid #fff;
		outline-offset: 2px;
		clip: auto;
		clip-path: none;
	}
	
	main {
		max-width: 1200px;
		margin: 0 auto;
		padding: 2rem;
		position: relative;
	}

	/* Prevent horizontal overflow on very small devices (~345px wide) */
	@media (max-width: 420px) {
		main {
			padding: 1rem;
		}
	}
</style>

